import{_ as p,af as y,P as _,t as g,ai as f,aj as S}from"./common-e61c72ea.js";import{k as n}from"./other-b5b79424.js";import"./vendor-54a376b9.js";const C={name:"lookHistory",components:{NoMore:y,Posters:_,Scroll:g},data(){return{loadingVideo:!1,loadingOther:!1,isClearHistoryVideo:!1,isClearHistoryOther:!1,currentSlideItemIndex:0,pageSize:15,historyVideo:{total:0,pageNo:0,list:[]},historyOther:{total:0,pageNo:0,list:[]}}},computed:{isClear(){return this.currentSlideItemIndex===0?this.historyVideo.list.length:this.historyOther.list.length}},created(){this.getHistoryVideo(!0),this.getHistoryOther(!0)},methods:{async getHistoryVideo(t=!1){if(this.loadingVideo||this.isClearHistoryVideo)return;if(!t){if(this.historyVideo.total<=this.historyVideo.list.length)return;this.historyVideo.pageNo++}this.loadingVideo=!0;let e=await f({pageNo:this.historyVideo.pageNo,pageSize:this.pageSize});this.loadingVideo=!1,e.code===this.SUCCESS&&(this.historyVideo.list=this.historyVideo.list.concat(e.data.list),this.historyVideo.total=e.data.total)},async getHistoryOther(t=!1){if(this.loadingOther||this.isClearHistoryOther)return;this.loadingOther=!0,t||this.historyOther.pageNo++;let e=await S({pageNo:this.historyOther.pageNo,pageSize:this.pageSize});this.loadingOther=!1,e.code===this.SUCCESS&&(this.historyOther.list=this.historyOther.list.concat(e.data.list),this.historyOther.total=e.data.total)},clear(){this.$showConfirmDialog("确定清空？","清空后，以往观看记录不再展示","gray",()=>{if(this.currentSlideItemIndex===0){this.historyVideo.list=[],this.isClearHistoryVideo=!0;return}this.historyOther.list=[],this.isClearHistoryVideo=!0})}}},r=t=>(Vue.pushScopeId("data-v-e2d096a7"),t=t(),Vue.popScopeId(),t),N={class:"lookHistory"},x=r(()=>Vue.createElementVNode("span",{class:"f16"},"观看历史",-1)),k={class:"content"},v={key:1,class:"empty"},I=r(()=>Vue.createElementVNode("img",{src:n,alt:""},null,-1)),H=r(()=>Vue.createElementVNode("div",{class:"title"},"暂无观看历史记录",-1)),O=[I,H],w=r(()=>Vue.createElementVNode("div",{class:"empty"},[Vue.createElementVNode("img",{src:n,alt:""}),Vue.createElementVNode("div",{class:"title"},"暂无观影历史记录")],-1));function B(t,e,E,z,o,s){const a=Vue.resolveComponent("BaseHeader"),d=Vue.resolveComponent("Indicator"),c=Vue.resolveComponent("Posters"),h=Vue.resolveComponent("Loading"),u=Vue.resolveComponent("NoMore"),V=Vue.resolveComponent("Scroll"),l=Vue.resolveComponent("SlideItem"),m=Vue.resolveComponent("SlideHorizontal");return Vue.openBlock(),Vue.createElementBlock("div",N,[Vue.createVNode(a,null,Vue.createSlots({center:Vue.withCtx(()=>[x]),_:2},[s.isClear?{name:"right",fn:Vue.withCtx(()=>[Vue.createElementVNode("span",{class:"second-text-color f13",onClick:e[0]||(e[0]=(...i)=>s.clear&&s.clear(...i))},"清空")]),key:"0"}:void 0]),1024),Vue.createElementVNode("div",k,[Vue.createVNode(d,{style:{width:"calc(100vw - 2rem)","margin-left":"1rem"},tabStyleWidth:"50%",tabTexts:["视频","影视综"],"active-index":o.currentSlideItemIndex,"onUpdate:activeIndex":e[1]||(e[1]=i=>o.currentSlideItemIndex=i)},null,8,["active-index"]),Vue.createVNode(m,{index:o.currentSlideItemIndex,"onUpdate:index":e[2]||(e[2]=i=>o.currentSlideItemIndex=i),class:"SlideRowList"},{default:Vue.withCtx(()=>[Vue.createVNode(l,{class:"tab1",style:{overflow:"auto"}},{default:Vue.withCtx(()=>[Vue.createVNode(V,{class:"Scroll",onPulldown:s.getHistoryVideo},{default:Vue.withCtx(()=>[o.historyVideo.total?(Vue.openBlock(),Vue.createBlock(c,{key:0,list:o.historyVideo.list},null,8,["list"])):Vue.createCommentVNode("",!0),o.loadingVideo?(Vue.openBlock(),Vue.createBlock(h,{key:1,"is-full-screen":!1})):(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:2},[o.historyVideo.list.length?(Vue.openBlock(),Vue.createBlock(u,{key:0})):(Vue.openBlock(),Vue.createElementBlock("div",v,O))],64))]),_:1},8,["onPulldown"])]),_:1}),Vue.createVNode(l,{class:"tab2"},{default:Vue.withCtx(()=>[w]),_:1})]),_:1},8,["index"])])])}const U=p(C,[["render",B],["__scopeId","data-v-e2d096a7"]]);export{U as default};
