import{m as _}from"./vendor-54a376b9.js";import{_ as p,u as h,Q as v}from"./common-e61c72ea.js";import{m as y,n as a,o as l}from"./other-b5b79424.js";const E={name:"MusicCollect",components:{},props:{},data(){return{loading:!1,list:[],audio:new Audio,currentItem:null,step:null,process:0}},computed:{..._(h,["bodyWidth"])},created(){this.getData()},mounted(){this.audio.addEventListener("loadedmetadata",e=>{this.currentItem.duration=this.audio.duration,this.step=this.bodyWidth/Math.floor(this.audio.duration)}),this.audio.addEventListener("timeupdate",e=>{this.process=Math.ceil(e.target.currentTime)*this.step})},methods:{async getData(){this.loading=!0;let e=await v();this.loading=!1,e.code===this.SUCCESS&&(this.list=e.data.music.list)},togglePlay(e,s){s.map(n=>{n.name!==e.name&&(n.is_play=!1)}),e.is_play=!e.is_play,e.is_play?(this.currentItem?this.currentItem.name!==e.name&&(this.audio.pause(),this.audio.src=e.mp3,this.audio.currentTime=0):(this.audio.pause(),this.audio.src=e.mp3,this.audio.currentTime=0),this.audio.play(),this.audio.addEventListener("ended",()=>e.is_play=!1)):this.stopPlay(),this.currentItem=e},stopPlay(){this.audio.pause(),this.audio.removeEventListener("ended",null)}},unmounted(){this.stopPlay()}},k=e=>(Vue.pushScopeId("data-v-9411ab3d"),e=e(),Vue.popScopeId(),e),g={class:"MusicCollect"},N=k(()=>Vue.createElementVNode("span",{class:"f16"},"音乐收藏",-1)),C={class:"content"},f={class:"list"},B=["onClick"],I={class:"music"},w={class:"cover-wrapper"},S={alt:"",class:"cover"},b={key:0,src:a,alt:"",class:"play"},D={key:1,src:l,alt:"",class:"play"},P={class:"desc"},L={class:"name"},M={class:"author"},z={class:"desc-bottom"},T={class:"duration"},x={class:"option"},H=["onClick"],W={key:0,class:"float-play-music"},A={class:"music-wrapper"},F={class:"music"},Q={alt:"",class:"cover"},U={key:0,src:a,alt:"",class:"play"},j={key:1,src:l,alt:"",class:"play"},q={class:"desc"},G={class:"name"},J={class:"desc-bottom"},K={class:"duration"},O={class:"option"};function R(e,s,n,X,t,c){const r=Vue.resolveComponent("BaseHeader"),u=Vue.resolveComponent("Loading"),d=Vue.resolveComponent("no-more"),m=Vue.resolveComponent("dy-button"),i=Vue.resolveDirective("lazy");return Vue.openBlock(),Vue.createElementBlock("div",g,[Vue.createVNode(r,null,{center:Vue.withCtx(()=>[N]),_:1}),Vue.createElementVNode("div",C,[Vue.createElementVNode("div",f,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.list,(o,Y)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"item",onClick:V=>c.togglePlay(o,t.list)},[Vue.createElementVNode("div",I,[Vue.createElementVNode("div",w,[Vue.withDirectives(Vue.createElementVNode("img",S,null,512),[[i,e.$imgPreview(o.cover)]]),o.is_play?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createElementBlock("img",b)),o.is_play?(Vue.openBlock(),Vue.createElementBlock("img",D)):Vue.createCommentVNode("",!0)]),Vue.createElementVNode("div",P,[Vue.createElementVNode("span",L,Vue.toDisplayString(o.name),1),Vue.createElementVNode("div",M,Vue.toDisplayString(o.author),1),Vue.createElementVNode("div",z,[Vue.createElementVNode("div",T,Vue.toDisplayString(e.$duration(o.duration)),1)])])]),Vue.createElementVNode("div",x,[Vue.createElementVNode("img",{src:y,alt:"",onClick:Vue.withModifiers(V=>e.$nav("/home/music",o),["stop"])},null,8,H)])],8,B))),256))]),t.loading?(Vue.openBlock(),Vue.createBlock(u,{key:0,"is-full-screen":!1})):(Vue.openBlock(),Vue.createBlock(d,{key:1,class:"mb7r"}))]),t.currentItem?(Vue.openBlock(),Vue.createElementBlock("div",W,[Vue.createElementVNode("div",{class:"process",style:Vue.normalizeStyle({width:t.process+"px"})},null,4),Vue.createElementVNode("div",A,[Vue.createElementVNode("div",F,[Vue.createElementVNode("div",{class:"cover-wrapper",onClick:s[0]||(s[0]=o=>c.togglePlay(t.currentItem,t.list))},[Vue.withDirectives(Vue.createElementVNode("img",Q,null,512),[[i,e.$imgPreview(t.currentItem.cover)]]),t.currentItem.is_play?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createElementBlock("img",U)),t.currentItem.is_play?(Vue.openBlock(),Vue.createElementBlock("img",j)):Vue.createCommentVNode("",!0)]),Vue.createElementVNode("div",q,[Vue.createElementVNode("span",G,Vue.toDisplayString(t.currentItem.name),1),Vue.createElementVNode("div",J,[Vue.createElementVNode("div",K,Vue.toDisplayString(e.$duration(t.currentItem.duration)),1)])])]),Vue.createElementVNode("div",O,[Vue.createVNode(m,{type:"primary",size:"small",onClick:e.$no},{default:Vue.withCtx(()=>[Vue.createTextVNode("使用")]),_:1},8,["onClick"])])])])):Vue.createCommentVNode("",!0)])}const te=p(E,[["render",R],["__scopeId","data-v-9411ab3d"]]);export{te as default};
